from aws_cdk import core, aws_kinesis as kinesis


class KinesisStream(core.Construct):
    def __init__(
        self, scope: core.Construct, id: str, delete_stream_on_teardown=False, **kwargs
    ) -> None:
        super().__init__(scope, id, **kwargs)

        removal_policy = core.RemovalPolicy.RETAIN
        if delete_stream_on_teardown:
            removal_policy = core.RemovalPolicy.DESTROY

        self.stream = kinesis.Stream(self, id)
        self.stream.apply_removal_policy(removal_policy)

    def get_stream_name(self):
        return self.stream.stream_name
