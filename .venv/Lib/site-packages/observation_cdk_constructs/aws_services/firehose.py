from aws_cdk import aws_s3 as s3, core
from aws_cdk import aws_kinesisfirehose as kinesisfirehose
from aws_cdk import aws_kinesis as kinesis
from aws_cdk import aws_kinesisfirehose_destinations as firehose_destinations


class Firehose(core.Construct):
    def __init__(
        self,
        scope: core.Construct,
        id: str,
        destination_bucket: s3.IBucket,
        source_stream: kinesis.IStream,
        buffer_interval: int,
        **kwargs,
    ) -> None:
        super().__init__(scope, id, **kwargs)

        firehose = kinesisfirehose.DeliveryStream(
            self,
            id,
            destinations=[
                firehose_destinations.S3Bucket(
                    destination_bucket,
                    buffering_interval=core.Duration.minutes(buffer_interval),
                )
            ],
            source_stream=source_stream,
        )
